import{a as Q}from"./chunk-QMEHBYW4.js";import{a as U,b as F,c as L,d as B,e as O,f as j,g as H,h as R,i as q,j as z,k as G}from"./chunk-TJEJZHC3.js";import{a as J,b as K}from"./chunk-SCQORROL.js";import{$ as g,B as w,C as E,J as h,K as _,L as v,M as k,N as C,O as e,P as t,Q as D,R as S,S as u,T as m,V as T,W as i,X as y,Y as b,_ as A,aa as x,ba as f,ca as M,fa as I,ga as P,n as c,na as V,o as p,oa as W,x as s,za as N}from"./chunk-JVVBI7EJ.js";var Y=(d,o)=>o.ticketID,Z=(d,o)=>o.assetID;function $(d,o){if(d&1&&(e(0,"div",48),i(1),t()),d&2){let n=m().$implicit;s(),y(n.description)}}function ee(d,o){if(d&1){let n=S();e(0,"tr",43)(1,"td",45)(2,"div",46),i(3),t()(),e(4,"td",47)(5,"div",46),i(6),t(),h(7,$,2,1,"div",48),t(),e(8,"td",45)(9,"div",49),i(10),t(),e(11,"div",48),i(12),t()(),e(13,"td",45)(14,"span"),i(15),t()(),e(16,"td",45)(17,"span"),i(18),t()(),e(19,"td",50),i(20),I(21,"date"),t(),e(22,"td",51)(23,"button",52),u("click",function(){let r=c(n).$implicit,l=m();return p(l.openUpdateModal(r))}),i(24," Edit "),t(),e(25,"button",53),u("click",function(){let r=c(n).$implicit,l=m();return p(l.deleteTicket(r.ticketID))}),i(26," Delete "),t()()()}if(d&2){let n=o.$implicit,a=m();s(3),y(n.userName),s(3),y(n.title),s(),_(n.description?7:-1),s(3),y(n.assetName),s(2),y(n.assetType),s(2),T(M("px-2 inline-flex text-xs leading-5 font-semibold rounded-full ",a.getPriorityColor(n.priority))),s(),b(" ",n.priority," "),s(2),T(M("px-2 inline-flex text-xs leading-5 font-semibold rounded-full ",a.getStatusColor(n.status))),s(),b(" ",n.status," "),s(2),b(" ",P(21,14,n.createdDate,"short")," ")}}function te(d,o){d&1&&(e(0,"tr")(1,"td",54),i(2,"No tickets found"),t()())}function ie(d,o){if(d&1){let n=S();e(0,"div",44)(1,"div",55)(2,"div",56),u("click",function(){c(n);let r=m();return p(r.closeUpdateModal())}),t(),e(3,"span",57),i(4,"\u200B"),t(),e(5,"div",58)(6,"div",59)(7,"h3",60),i(8,"Update Ticket"),t(),e(9,"form",61),u("ngSubmit",function(){c(n);let r=m();return p(r.updateTicket())}),e(10,"div",62)(11,"div")(12,"label",63),i(13,"Title"),t(),e(14,"input",64),f("ngModelChange",function(r){c(n);let l=m();return x(l.updateData.title,r)||(l.updateData.title=r),p(r)}),t()(),e(15,"div")(16,"label",65),i(17,"Description"),t(),e(18,"textarea",66),f("ngModelChange",function(r){c(n);let l=m();return x(l.updateData.description,r)||(l.updateData.description=r),p(r)}),t()(),e(19,"div")(20,"label",67),i(21,"Priority"),t(),e(22,"select",68),f("ngModelChange",function(r){c(n);let l=m();return x(l.updateData.priority,r)||(l.updateData.priority=r),p(r)}),e(23,"option",27),i(24,"Low"),t(),e(25,"option",28),i(26,"Medium"),t(),e(27,"option",29),i(28,"High"),t()()(),e(29,"div")(30,"label",69),i(31,"Status"),t(),e(32,"select",70),f("ngModelChange",function(r){c(n);let l=m();return x(l.updateData.status,r)||(l.updateData.status=r),p(r)}),e(33,"option",21),i(34,"Open"),t(),e(35,"option",22),i(36,"In Progress"),t(),e(37,"option",23),i(38,"Resolved"),t(),e(39,"option",24),i(40,"Closed"),t()()()(),e(41,"div",71)(42,"button",72),i(43),t(),e(44,"button",73),u("click",function(){c(n);let r=m();return p(r.closeUpdateModal())}),i(45," Cancel "),t()()()()()()()}if(d&2){let n=m();s(14),g("ngModel",n.updateData.title),s(4),g("ngModel",n.updateData.description),s(4),g("ngModel",n.updateData.priority),s(10),g("ngModel",n.updateData.status),s(10),C("disabled",n.loading),s(),b(" ",n.loading?"Updating...":"Update Ticket"," ")}}function ne(d,o){if(d&1&&(e(0,"div",74),i(1),t()),d&2){let n=m(2);s(),b(" ",n.errorMessage," ")}}function re(d,o){if(d&1&&(e(0,"option",77),i(1),t()),d&2){let n=o.$implicit;C("value",n.assetID),s(),A("",n.assetName," (",n.assetType,") - ",n.userName)}}function oe(d,o){if(d&1){let n=S();e(0,"div",44)(1,"div",55)(2,"div",56),u("click",function(){c(n);let r=m();return p(r.closeCreateTicketModal())}),t(),e(3,"span",57),i(4,"\u200B"),t(),e(5,"div",58)(6,"div",59)(7,"h3",60),i(8,"Create New Ticket"),t(),h(9,ne,2,1,"div",74),e(10,"form",61),u("ngSubmit",function(){c(n);let r=m();return p(r.createTicket())}),e(11,"div",62)(12,"div")(13,"label",75),i(14,"Asset"),t(),e(15,"select",76),f("ngModelChange",function(r){c(n);let l=m();return x(l.newTicket.assetID,r)||(l.newTicket.assetID=r),p(r)}),v(16,re,2,4,"option",77,Z),t()(),e(18,"div")(19,"label",78),i(20,"Title"),t(),e(21,"input",79),f("ngModelChange",function(r){c(n);let l=m();return x(l.newTicket.title,r)||(l.newTicket.title=r),p(r)}),t()(),e(22,"div")(23,"label",80),i(24,"Description"),t(),e(25,"textarea",81),f("ngModelChange",function(r){c(n);let l=m();return x(l.newTicket.description,r)||(l.newTicket.description=r),p(r)}),t()(),e(26,"div")(27,"label",82),i(28,"Priority"),t(),e(29,"select",83),f("ngModelChange",function(r){c(n);let l=m();return x(l.newTicket.priority,r)||(l.newTicket.priority=r),p(r)}),e(30,"option",27),i(31,"Low"),t(),e(32,"option",28),i(33,"Medium"),t(),e(34,"option",29),i(35,"High"),t()()()(),e(36,"div",71)(37,"button",72),i(38),t(),e(39,"button",73),u("click",function(){c(n);let r=m();return p(r.closeCreateTicketModal())}),i(40," Cancel "),t()()()()()()()}if(d&2){let n=m();s(9),_(n.errorMessage?9:-1),s(6),g("ngModel",n.newTicket.assetID),s(),k(n.assets),s(5),g("ngModel",n.newTicket.title),s(4),g("ngModel",n.newTicket.description),s(4),g("ngModel",n.newTicket.priority),s(8),C("disabled",n.loading),s(),b(" ",n.loading?"Creating...":"Create Ticket"," ")}}var X=class d{constructor(o,n,a){this.ticketService=o;this.assetService=n;this.authService=a}tickets=[];assets=[];filteredTickets=[];selectedTicket=null;showUpdateModal=!1;showCreateTicketModal=!1;updateData={};newTicket={assetID:"",title:"",description:"",priority:"Medium"};loading=!1;errorMessage="";filterStatus="";filterPriority="";filterAssetType="";ngOnInit(){this.loadTickets(),this.loadAssets()}loadTickets(){this.ticketService.getTickets().subscribe({next:o=>{this.tickets=o,this.applyFilters()},error:o=>{console.error("Error loading tickets:",o)}})}loadAssets(){this.assetService.getAssets().subscribe({next:o=>{this.assets=o},error:o=>{console.error("Error loading assets:",o)}})}applyFilters(){this.filteredTickets=this.tickets.filter(o=>{let n=!this.filterStatus||o.status===this.filterStatus,a=!this.filterPriority||o.priority===this.filterPriority,r=!this.filterAssetType||o.assetType===this.filterAssetType;return n&&a&&r})}openUpdateModal(o){this.selectedTicket=o,this.updateData={title:o.title,description:o.description,priority:o.priority,status:o.status},this.showUpdateModal=!0}closeUpdateModal(){this.showUpdateModal=!1,this.selectedTicket=null}openCreateTicketModal(){this.showCreateTicketModal=!0,this.newTicket={assetID:this.assets[0]?.assetID||"",title:"",description:"",priority:"Medium"},this.errorMessage=""}closeCreateTicketModal(){this.showCreateTicketModal=!1,this.errorMessage=""}createTicket(){if(!this.newTicket.title||!this.newTicket.assetID){this.errorMessage="Please fill in all required fields";return}this.loading=!0,this.ticketService.createTicket(this.newTicket).subscribe({next:()=>{this.loading=!1,this.closeCreateTicketModal(),this.loadTickets()},error:o=>{this.loading=!1,this.errorMessage=o.error?.message||"Error creating ticket"}})}updateTicket(){this.selectedTicket&&(this.loading=!0,this.ticketService.updateTicket(this.selectedTicket.ticketID,this.updateData).subscribe({next:()=>{this.loading=!1,this.closeUpdateModal(),this.loadTickets()},error:o=>{this.loading=!1,console.error("Error updating ticket:",o)}}))}deleteTicket(o){confirm("Are you sure you want to delete this ticket?")&&this.ticketService.deleteTicket(o).subscribe({next:()=>{this.loadTickets()},error:n=>{console.error("Error deleting ticket:",n)}})}getStatusColor(o){switch(o){case"Open":return"bg-blue-100 text-blue-800";case"In Progress":return"bg-yellow-100 text-yellow-800";case"Resolved":return"bg-green-100 text-green-800";case"Closed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}}getPriorityColor(o){switch(o){case"High":return"bg-red-100 text-red-800";case"Medium":return"bg-orange-100 text-orange-800";case"Low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}}getTicketStats(){return{total:this.tickets.length,open:this.tickets.filter(o=>o.status==="Open").length,inProgress:this.tickets.filter(o=>o.status==="In Progress").length,resolved:this.tickets.filter(o=>o.status==="Resolved").length}}getUserFirstName(){let o=this.authService.getCurrentUser();return o&&o.fullName?o.fullName.split(" ")[0]:"User"}static \u0275fac=function(n){return new(n||d)(w(Q),w(K),w(N))};static \u0275cmp=E({type:d,selectors:[["app-admin-dashboard"]],decls:111,vars:11,consts:[[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-8"],[1,"mb-8","flex","justify-between","items-start"],[1,"text-3xl","font-bold","text-gray-900"],[1,"mt-2","text-xl","font-semibold","text-gray-700"],[1,"mt-1","text-gray-600"],[1,"px-3","py-1.5","bg-primary","text-white","rounded-md","hover:bg-opacity-90","transition-colors","font-medium","text-sm",3,"click"],[1,"grid","grid-cols-1","md:grid-cols-4","gap-4","mb-8"],[1,"bg-white","rounded-lg","shadow-md","p-6"],[1,"flex","items-center"],[1,"flex-1"],[1,"text-sm","font-medium","text-gray-600"],[1,"text-2xl","font-bold","text-gray-900"],[1,"text-2xl","font-bold","text-blue-600"],[1,"text-2xl","font-bold","text-yellow-600"],[1,"text-2xl","font-bold","text-green-600"],[1,"bg-white","rounded-lg","shadow-md","p-6","mb-6"],[1,"text-lg","font-semibold","text-gray-900","mb-4"],[1,"grid","grid-cols-1","md:grid-cols-3","gap-4"],["for","filterStatus",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","filterStatus",1,"block","w-full","pl-3","pr-10","py-2","text-base","border-gray-300","focus:outline-none","focus:ring-primary","focus:border-primary","sm:text-sm","rounded-md","border",3,"ngModelChange","change","ngModel"],["value",""],["value","Open"],["value","In Progress"],["value","Resolved"],["value","Closed"],["for","filterPriority",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","filterPriority",1,"block","w-full","pl-3","pr-10","py-2","text-base","border-gray-300","focus:outline-none","focus:ring-primary","focus:border-primary","sm:text-sm","rounded-md","border",3,"ngModelChange","change","ngModel"],["value","Low"],["value","Medium"],["value","High"],["for","filterAssetType",1,"block","text-sm","font-medium","text-gray-700","mb-1"],["id","filterAssetType",1,"block","w-full","pl-3","pr-10","py-2","text-base","border-gray-300","focus:outline-none","focus:ring-primary","focus:border-primary","sm:text-sm","rounded-md","border",3,"ngModelChange","change","ngModel"],["value","Home"],["value","Vehicle"],["value","Personal Property"],[1,"mb-6"],[1,"text-xl","font-semibold","text-gray-900"],[1,"bg-white","rounded-lg","shadow-md","overflow-hidden","border","border-gray-200"],[1,"overflow-x-auto"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],[1,"hover:bg-gray-50"],["aria-labelledby","modal-title","role","dialog","aria-modal","true",1,"fixed","z-10","inset-0","overflow-y-auto"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm","font-medium","text-gray-900"],[1,"px-6","py-4"],[1,"text-sm","text-gray-500"],[1,"text-sm","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-500"],[1,"px-6","py-4","whitespace-nowrap","text-sm","font-medium"],[1,"text-primary","hover:text-opacity-80","mr-3",3,"click"],[1,"text-red-600","hover:text-red-900",3,"click"],["colspan","7",1,"px-6","py-4","text-center","text-gray-500"],[1,"flex","items-end","justify-center","min-h-screen","pt-4","px-4","pb-20","text-center","sm:block","sm:p-0"],[1,"fixed","inset-0","bg-gray-500","bg-opacity-75","transition-opacity",3,"click"],["aria-hidden","true",1,"hidden","sm:inline-block","sm:align-middle","sm:h-screen"],[1,"inline-block","align-bottom","bg-white","rounded-lg","text-left","overflow-hidden","shadow-xl","transform","transition-all","sm:my-8","sm:align-middle","sm:max-w-lg","sm:w-full"],[1,"bg-white","px-4","pt-5","pb-4","sm:p-6","sm:pb-4"],[1,"text-lg","leading-6","font-medium","text-gray-900","mb-4"],[3,"ngSubmit"],[1,"space-y-4"],["for","updateTitle",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","updateTitle","name","title",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-primary","focus:border-primary","sm:text-sm",3,"ngModelChange","ngModel"],["for","updateDescription",1,"block","text-sm","font-medium","text-gray-700"],["id","updateDescription","name","description","rows","3",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-primary","focus:border-primary","sm:text-sm",3,"ngModelChange","ngModel"],["for","updatePriority",1,"block","text-sm","font-medium","text-gray-700"],["id","updatePriority","name","priority",1,"mt-1","block","w-full","pl-3","pr-10","py-2","text-base","border-gray-300","focus:outline-none","focus:ring-primary","focus:border-primary","sm:text-sm","rounded-md","border",3,"ngModelChange","ngModel"],["for","updateStatus",1,"block","text-sm","font-medium","text-gray-700"],["id","updateStatus","name","status",1,"mt-1","block","w-full","pl-3","pr-10","py-2","text-base","border-gray-300","focus:outline-none","focus:ring-primary","focus:border-primary","sm:text-sm","rounded-md","border",3,"ngModelChange","ngModel"],[1,"mt-5","sm:mt-6","sm:grid","sm:grid-cols-2","sm:gap-3","sm:grid-flow-row-dense"],["type","submit",1,"w-full","inline-flex","justify-center","rounded-md","border","border-transparent","shadow-sm","px-4","py-2","bg-primary","text-base","font-medium","text-white","hover:bg-opacity-90","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-primary","sm:col-start-2","sm:text-sm","disabled:opacity-50",3,"disabled"],["type","button",1,"mt-3","w-full","inline-flex","justify-center","rounded-md","border","border-gray-300","shadow-sm","px-4","py-2","bg-white","text-base","font-medium","text-gray-700","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-primary","sm:mt-0","sm:col-start-1","sm:text-sm",3,"click"],[1,"mb-4","bg-red-50","border","border-red-200","text-red-600","px-4","py-3","rounded"],["for","asset",1,"block","text-sm","font-medium","text-gray-700"],["id","asset","name","assetID","required","",1,"mt-1","block","w-full","pl-3","pr-10","py-2","text-base","border-gray-300","focus:outline-none","focus:ring-primary","focus:border-primary","sm:text-sm","rounded-md","border",3,"ngModelChange","ngModel"],[3,"value"],["for","title",1,"block","text-sm","font-medium","text-gray-700"],["type","text","id","title","name","title","required","","placeholder","Enter ticket title",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-primary","focus:border-primary","sm:text-sm",3,"ngModelChange","ngModel"],["for","description",1,"block","text-sm","font-medium","text-gray-700"],["id","description","name","description","rows","3","placeholder","Enter ticket description",1,"mt-1","block","w-full","border","border-gray-300","rounded-md","shadow-sm","py-2","px-3","focus:outline-none","focus:ring-primary","focus:border-primary","sm:text-sm",3,"ngModelChange","ngModel"],["for","priority",1,"block","text-sm","font-medium","text-gray-700"],["id","priority","name","priority",1,"mt-1","block","w-full","pl-3","pr-10","py-2","text-base","border-gray-300","focus:outline-none","focus:ring-primary","focus:border-primary","sm:text-sm","rounded-md","border",3,"ngModelChange","ngModel"]],template:function(n,a){n&1&&(D(0,"app-navbar"),e(1,"div",0)(2,"div",1)(3,"div")(4,"h1",2),i(5),t(),e(6,"h2",3),i(7,"Admin Dashboard"),t(),e(8,"p",4),i(9,"Manage all tickets and assets across the system"),t()(),e(10,"button",5),u("click",function(){return a.openCreateTicketModal()}),i(11," Create New Ticket "),t()(),e(12,"div",6)(13,"div",7)(14,"div",8)(15,"div",9)(16,"p",10),i(17,"Total Tickets"),t(),e(18,"p",11),i(19),t()()()(),e(20,"div",7)(21,"div",8)(22,"div",9)(23,"p",10),i(24,"Open"),t(),e(25,"p",12),i(26),t()()()(),e(27,"div",7)(28,"div",8)(29,"div",9)(30,"p",10),i(31,"In Progress"),t(),e(32,"p",13),i(33),t()()()(),e(34,"div",7)(35,"div",8)(36,"div",9)(37,"p",10),i(38,"Resolved"),t(),e(39,"p",14),i(40),t()()()()(),e(41,"div",15)(42,"h3",16),i(43,"Filters"),t(),e(44,"div",17)(45,"div")(46,"label",18),i(47,"Status"),t(),e(48,"select",19),f("ngModelChange",function(l){return x(a.filterStatus,l)||(a.filterStatus=l),l}),u("change",function(){return a.applyFilters()}),e(49,"option",20),i(50,"All Statuses"),t(),e(51,"option",21),i(52,"Open"),t(),e(53,"option",22),i(54,"In Progress"),t(),e(55,"option",23),i(56,"Resolved"),t(),e(57,"option",24),i(58,"Closed"),t()()(),e(59,"div")(60,"label",25),i(61,"Priority"),t(),e(62,"select",26),f("ngModelChange",function(l){return x(a.filterPriority,l)||(a.filterPriority=l),l}),u("change",function(){return a.applyFilters()}),e(63,"option",20),i(64,"All Priorities"),t(),e(65,"option",27),i(66,"Low"),t(),e(67,"option",28),i(68,"Medium"),t(),e(69,"option",29),i(70,"High"),t()()(),e(71,"div")(72,"label",30),i(73,"Asset Type"),t(),e(74,"select",31),f("ngModelChange",function(l){return x(a.filterAssetType,l)||(a.filterAssetType=l),l}),u("change",function(){return a.applyFilters()}),e(75,"option",20),i(76,"All Types"),t(),e(77,"option",32),i(78,"Home"),t(),e(79,"option",33),i(80,"Vehicle"),t(),e(81,"option",34),i(82,"Personal Property"),t()()()()(),e(83,"div",35)(84,"h3",36),i(85,"All Tickets"),t()(),e(86,"div",37)(87,"div",38)(88,"table",39)(89,"thead",40)(90,"tr")(91,"th",41),i(92,"User"),t(),e(93,"th",41),i(94,"Title"),t(),e(95,"th",41),i(96,"Asset"),t(),e(97,"th",41),i(98,"Priority"),t(),e(99,"th",41),i(100,"Status"),t(),e(101,"th",41),i(102,"Created"),t(),e(103,"th",41),i(104,"Actions"),t()()(),e(105,"tbody",42),v(106,ee,27,17,"tr",43,Y,!1,te,3,0,"tr"),t()()()()(),h(109,ie,46,6,"div",44),h(110,oe,41,7,"div",44)),n&2&&(s(5),b("Welcome, ",a.getUserFirstName(),"!"),s(14),y(a.getTicketStats().total),s(7),y(a.getTicketStats().open),s(7),y(a.getTicketStats().inProgress),s(7),y(a.getTicketStats().resolved),s(8),g("ngModel",a.filterStatus),s(14),g("ngModel",a.filterPriority),s(12),g("ngModel",a.filterAssetType),s(32),k(a.filteredTickets),s(3),_(a.showUpdateModal&&a.selectedTicket?109:-1),s(),_(a.showCreateTicketModal?110:-1))},dependencies:[W,G,j,R,q,U,H,F,L,z,O,B,J,V],encapsulation:2})};export{X as AdminDashboardComponent};
