import{a as B}from"./chunk-W4XRG47B.js";import{a as F}from"./chunk-HS72ZNLO.js";import{a as V}from"./chunk-664333HR.js";import{B as x,C as k,Ca as R,J as l,K as d,M as A,N as w,P as t,Q as i,R as u,S as E,T as f,U as c,X as h,Y as r,Z as m,_ as p,ea as _,ia as D,ja as I,n as C,o as b,p as v,q as S,qa as T,ra as M,wa as N,x as a,ya as j}from"./chunk-IIWWASKY.js";var O=(o,n)=>n.ticketID;function $(o,n){if(o&1&&(t(0,"div",5),r(1),i()),o&2){let e=c();a(),p(" ",e.errorMessage," ")}}function H(o,n){o&1&&(t(0,"div",6),u(1,"div",7),t(2,"p",8),r(3,"Loading asset details..."),i()())}function L(o,n){if(o&1&&(t(0,"div")(1,"dt",14),r(2,"Owner"),i(),t(3,"dd",19),r(4),i()()),o&2){let e=c(2);a(4),m(e.asset.userName)}}function U(o,n){o&1&&(t(0,"th",26),r(1,"User"),i())}function G(o,n){if(o&1&&(t(0,"td",30)(1,"div",34),r(2),i()()),o&2){let e=c().$implicit;a(2),m(e.userName)}}function z(o,n){if(o&1){let e=E();t(0,"tr",29),f("click",function(){let g=C(e).$implicit,y=c(3);return b(y.viewTicketDetail(g.ticketID))}),t(1,"td",30)(2,"div",31),r(3),i()(),l(4,G,3,1,"td",30),t(5,"td",30)(6,"span"),r(7),i()(),t(8,"td",30)(9,"span"),r(10),i()(),t(11,"td",32),r(12),D(13,"date"),i(),t(14,"td",33)(15,"div",34),r(16),i()()()}if(o&2){let e=n.$implicit,s=c(3);a(3),m(e.title),a(),d(s.isAdmin?4:-1),a(2),h(_("px-2 inline-flex text-xs leading-5 font-semibold rounded-full ",s.getPriorityColor(e.priority))),a(),p(" ",e.priority," "),a(2),h(_("px-2 inline-flex text-xs leading-5 font-semibold rounded-full ",s.getStatusColor(e.status))),a(),p(" ",e.status," "),a(2),p(" ",I(13,12,e.createdDate,"short")," "),a(4),m(e.description||"No description")}}function Y(o,n){if(o&1&&(t(0,"div",22)(1,"table",24)(2,"thead",25)(3,"tr")(4,"th",26),r(5,"Title"),i(),l(6,U,2,0,"th",26),t(7,"th",26),r(8,"Priority"),i(),t(9,"th",26),r(10,"Status"),i(),t(11,"th",26),r(12,"Created"),i(),t(13,"th",26),r(14,"Description"),i()()(),t(15,"tbody",27),A(16,z,17,15,"tr",28,O),i()()()),o&2){let e=c(2);a(6),d(e.isAdmin?6:-1),a(10),w(e.tickets)}}function q(o,n){o&1&&(t(0,"div",23),v(),t(1,"svg",35),u(2,"path",36),i(),S(),t(3,"h3",37),r(4,"No tickets"),i(),t(5,"p",38),r(6,"This asset doesn't have any associated tickets yet."),i()())}function J(o,n){if(o&1&&(t(0,"div",9)(1,"div",10)(2,"h1",11),r(3,"Asset Details"),i()(),t(4,"div",12)(5,"dl",13)(6,"div")(7,"dt",14),r(8,"Asset Name"),i(),t(9,"dd",15),r(10),i()(),t(11,"div")(12,"dt",14),r(13,"Asset Type"),i(),t(14,"dd",16)(15,"span",17),r(16),i()()(),l(17,L,5,1,"div"),t(18,"div",18)(19,"dt",14),r(20,"Description"),i(),t(21,"dd",19),r(22),i()()()()(),t(23,"div",20)(24,"div",10)(25,"h2",21),r(26),i()(),l(27,Y,18,1,"div",22)(28,q,7,0,"div",23),i()),o&2){let e=c();a(10),m(e.asset.assetName),a(6),p(" ",e.asset.assetType," "),a(),d(e.isAdmin?17:-1),a(5),m(e.asset.description||"No description provided"),a(4),p(" Associated Tickets (",e.tickets.length,") "),a(),d(e.tickets.length>0?27:28)}}var P=class o{constructor(n,e,s,g,y){this.route=n;this.router=e;this.assetService=s;this.ticketService=g;this.authService=y;this.isAdmin=this.authService.isAdmin()}asset=null;tickets=[];loading=!1;errorMessage="";isAdmin=!1;ngOnInit(){let n=this.route.snapshot.paramMap.get("id");n?this.loadAssetDetails(n):this.errorMessage="Asset ID not found"}loadAssetDetails(n){this.loading=!0,this.assetService.getAssets().subscribe({next:e=>{if(this.asset=e.find(g=>g.assetID===n)||null,!this.asset){this.errorMessage="Asset not found",this.loading=!1;return}let s=this.authService.getCurrentUser();if(!this.isAdmin&&s&&this.asset.userID!==s.userID){this.errorMessage="You do not have permission to view this asset",this.loading=!1;return}this.loadTickets(n)},error:e=>{console.error("Error loading asset:",e),this.errorMessage="Failed to load asset details",this.loading=!1}})}loadTickets(n){this.ticketService.getTickets().subscribe({next:e=>{this.tickets=e.filter(s=>s.assetID===n),this.loading=!1},error:e=>{console.error("Error loading tickets:",e),this.errorMessage="Failed to load tickets",this.loading=!1}})}goBack(){this.isAdmin?this.router.navigate(["/assets/admin"]):this.router.navigate(["/assets/user"])}getPriorityColor(n){switch(n){case"High":return"bg-red-100 text-red-800";case"Medium":return"bg-yellow-100 text-yellow-800";case"Low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}}getStatusColor(n){switch(n){case"Open":return"bg-blue-100 text-blue-800";case"In Progress":return"bg-yellow-100 text-yellow-800";case"Resolved":return"bg-green-100 text-green-800";case"Closed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}}viewTicketDetail(n){this.router.navigate(["/tickets/detail",n])}static \u0275fac=function(e){return new(e||o)(x(N),x(j),x(B),x(F),x(R))};static \u0275cmp=k({type:o,selectors:[["app-asset-detail"]],decls:10,vars:3,consts:[[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-8"],[1,"mb-6"],[1,"inline-flex","items-center","px-3","py-1.5","border","border-gray-300","rounded-md","text-xs","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-primary",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1.5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"mb-6","bg-red-50","border","border-red-200","text-red-600","px-4","py-3","rounded"],[1,"text-center","py-12"],[1,"inline-block","animate-spin","rounded-full","h-8","w-8","border-b-2","border-primary"],[1,"mt-2","text-gray-600"],[1,"bg-white","rounded-lg","shadow-md","overflow-hidden","mb-8","border","border-gray-200"],[1,"px-6","py-4","border-b","border-gray-200","bg-gray-50"],[1,"text-2xl","font-bold","text-gray-900"],[1,"px-6","py-6"],[1,"grid","grid-cols-1","gap-x-4","gap-y-6","sm:grid-cols-2"],[1,"text-sm","font-medium","text-gray-500"],[1,"mt-1","text-md","font-semibold","text-gray-900"],[1,"mt-1"],[1,"inline-flex","items-center","px-3","py-1","rounded-full","text-sm","font-semibold","bg-blue-100","text-blue-800"],[1,"sm:col-span-2"],[1,"mt-1","text-md","text-gray-900"],[1,"bg-white","rounded-lg","shadow-md","overflow-hidden","border","border-gray-200"],[1,"text-xl","font-semibold","text-gray-900"],[1,"overflow-x-auto"],[1,"px-6","py-12","text-center"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],[1,"hover:bg-gray-50","cursor-pointer"],[1,"hover:bg-gray-50","cursor-pointer",3,"click"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm","font-medium","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-500"],[1,"px-6","py-4"],[1,"text-sm","text-gray-900"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"]],template:function(e,s){e&1&&(u(0,"app-navbar"),t(1,"div",0)(2,"div",1)(3,"button",2),f("click",function(){return s.goBack()}),v(),t(4,"svg",3),u(5,"path",4),i(),r(6," Back to Assets "),i()(),l(7,$,2,1,"div",5),l(8,H,4,0,"div",6),l(9,J,29,6),i()),e&2&&(a(7),d(s.errorMessage?7:-1),a(),d(s.loading?8:-1),a(),d(s.asset&&!s.loading?9:-1))},dependencies:[M,V,T],encapsulation:2})};export{P as AssetDetailComponent};
