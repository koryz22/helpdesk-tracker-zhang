import{a as j}from"./chunk-VPQVV7DC.js";import{a as M,b as N}from"./chunk-OJR6FQHL.js";import{B as x,C as _,J as d,K as l,L as b,M as C,O as t,P as i,Q as g,S,T as m,V as f,W as n,X as c,Y as p,ca as h,fa as A,ga as k,na as E,oa as w,p as v,q as y,ta as D,va as I,x as o,za as T}from"./chunk-JVVBI7EJ.js";var B=(a,r)=>r.ticketID;function P(a,r){if(a&1&&(t(0,"div",5),n(1),i()),a&2){let e=m();o(),p(" ",e.errorMessage," ")}}function F(a,r){a&1&&(t(0,"div",6),g(1,"div",7),t(2,"p",8),n(3,"Loading asset details..."),i()())}function O(a,r){if(a&1&&(t(0,"div")(1,"dt",14),n(2,"Owner"),i(),t(3,"dd",19),n(4),i()()),a&2){let e=m(2);o(4),c(e.asset.userName)}}function V(a,r){a&1&&(t(0,"th",26),n(1,"User"),i())}function H(a,r){if(a&1&&(t(0,"td",29)(1,"div",33),n(2),i()()),a&2){let e=m().$implicit;o(2),c(e.userName)}}function L(a,r){if(a&1&&(t(0,"tr",28)(1,"td",29)(2,"div",30),n(3),i()(),d(4,H,3,1,"td",29),t(5,"td",29)(6,"span"),n(7),i()(),t(8,"td",29)(9,"span"),n(10),i()(),t(11,"td",31),n(12),A(13,"date"),i(),t(14,"td",32)(15,"div",33),n(16),i()()()),a&2){let e=r.$implicit,s=m(3);o(3),c(e.title),o(),l(s.isAdmin?4:-1),o(2),f(h("px-2 inline-flex text-xs leading-5 font-semibold rounded-full ",s.getPriorityColor(e.priority))),o(),p(" ",e.priority," "),o(2),f(h("px-2 inline-flex text-xs leading-5 font-semibold rounded-full ",s.getStatusColor(e.status))),o(),p(" ",e.status," "),o(2),p(" ",k(13,12,e.createdDate,"short")," "),o(4),c(e.description||"No description")}}function U(a,r){if(a&1&&(t(0,"div",22)(1,"table",24)(2,"thead",25)(3,"tr")(4,"th",26),n(5,"Title"),i(),d(6,V,2,0,"th",26),t(7,"th",26),n(8,"Priority"),i(),t(9,"th",26),n(10,"Status"),i(),t(11,"th",26),n(12,"Created"),i(),t(13,"th",26),n(14,"Description"),i()()(),t(15,"tbody",27),b(16,L,17,15,"tr",28,B),i()()()),a&2){let e=m(2);o(6),l(e.isAdmin?6:-1),o(10),C(e.tickets)}}function $(a,r){a&1&&(t(0,"div",23),v(),t(1,"svg",34),g(2,"path",35),i(),y(),t(3,"h3",36),n(4,"No tickets"),i(),t(5,"p",37),n(6,"This asset doesn't have any associated tickets yet."),i()())}function G(a,r){if(a&1&&(t(0,"div",9)(1,"div",10)(2,"h1",11),n(3,"Asset Details"),i()(),t(4,"div",12)(5,"dl",13)(6,"div")(7,"dt",14),n(8,"Asset Name"),i(),t(9,"dd",15),n(10),i()(),t(11,"div")(12,"dt",14),n(13,"Asset Type"),i(),t(14,"dd",16)(15,"span",17),n(16),i()()(),d(17,O,5,1,"div"),t(18,"div",18)(19,"dt",14),n(20,"Description"),i(),t(21,"dd",19),n(22),i()()()()(),t(23,"div",20)(24,"div",10)(25,"h2",21),n(26),i()(),d(27,U,18,1,"div",22)(28,$,7,0,"div",23),i()),a&2){let e=m();o(10),c(e.asset.assetName),o(6),p(" ",e.asset.assetType," "),o(),l(e.isAdmin?17:-1),o(5),c(e.asset.description||"No description provided"),o(4),p(" Associated Tickets (",e.tickets.length,") "),o(),l(e.tickets.length>0?27:28)}}var R=class a{constructor(r,e,s,u,z){this.route=r;this.router=e;this.assetService=s;this.ticketService=u;this.authService=z;this.isAdmin=this.authService.isAdmin()}asset=null;tickets=[];loading=!1;errorMessage="";isAdmin=!1;ngOnInit(){let r=this.route.snapshot.paramMap.get("id");r?this.loadAssetDetails(r):this.errorMessage="Asset ID not found"}loadAssetDetails(r){this.loading=!0,this.assetService.getAssets().subscribe({next:e=>{if(this.asset=e.find(u=>u.assetID===r)||null,!this.asset){this.errorMessage="Asset not found",this.loading=!1;return}let s=this.authService.getCurrentUser();if(!this.isAdmin&&s&&this.asset.userID!==s.userID){this.errorMessage="You do not have permission to view this asset",this.loading=!1;return}this.loadTickets(r)},error:e=>{console.error("Error loading asset:",e),this.errorMessage="Failed to load asset details",this.loading=!1}})}loadTickets(r){this.ticketService.getTickets().subscribe({next:e=>{this.tickets=e.filter(s=>s.assetID===r),this.loading=!1},error:e=>{console.error("Error loading tickets:",e),this.errorMessage="Failed to load tickets",this.loading=!1}})}goBack(){this.isAdmin?this.router.navigate(["/assets/admin"]):this.router.navigate(["/assets/user"])}getPriorityColor(r){switch(r){case"High":return"bg-red-100 text-red-800";case"Medium":return"bg-yellow-100 text-yellow-800";case"Low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}}getStatusColor(r){switch(r){case"Open":return"bg-blue-100 text-blue-800";case"In Progress":return"bg-yellow-100 text-yellow-800";case"Resolved":return"bg-green-100 text-green-800";case"Closed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}}static \u0275fac=function(e){return new(e||a)(x(D),x(I),x(N),x(j),x(T))};static \u0275cmp=_({type:a,selectors:[["app-asset-detail"]],decls:10,vars:3,consts:[[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-8"],[1,"mb-6"],[1,"inline-flex","items-center","px-3","py-1.5","border","border-gray-300","rounded-md","text-xs","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-primary",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1.5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"mb-6","bg-red-50","border","border-red-200","text-red-600","px-4","py-3","rounded"],[1,"text-center","py-12"],[1,"inline-block","animate-spin","rounded-full","h-8","w-8","border-b-2","border-primary"],[1,"mt-2","text-gray-600"],[1,"bg-white","rounded-lg","shadow-md","overflow-hidden","mb-8","border","border-gray-200"],[1,"px-6","py-4","border-b","border-gray-200","bg-gray-50"],[1,"text-2xl","font-bold","text-gray-900"],[1,"px-6","py-6"],[1,"grid","grid-cols-1","gap-x-4","gap-y-6","sm:grid-cols-2"],[1,"text-sm","font-medium","text-gray-500"],[1,"mt-1","text-md","font-semibold","text-gray-900"],[1,"mt-1"],[1,"inline-flex","items-center","px-3","py-1","rounded-full","text-sm","font-semibold","bg-blue-100","text-blue-800"],[1,"sm:col-span-2"],[1,"mt-1","text-md","text-gray-900"],[1,"bg-white","rounded-lg","shadow-md","overflow-hidden","border","border-gray-200"],[1,"text-xl","font-semibold","text-gray-900"],[1,"overflow-x-auto"],[1,"px-6","py-12","text-center"],[1,"min-w-full","divide-y","divide-gray-200"],[1,"bg-gray-50"],[1,"px-6","py-3","text-left","text-xs","font-medium","text-gray-500","uppercase","tracking-wider"],[1,"bg-white","divide-y","divide-gray-200"],[1,"hover:bg-gray-50"],[1,"px-6","py-4","whitespace-nowrap"],[1,"text-sm","font-medium","text-gray-900"],[1,"px-6","py-4","whitespace-nowrap","text-sm","text-gray-500"],[1,"px-6","py-4"],[1,"text-sm","text-gray-900"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"mx-auto","h-12","w-12","text-gray-400"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"],[1,"mt-2","text-sm","font-medium","text-gray-900"],[1,"mt-1","text-sm","text-gray-500"]],template:function(e,s){e&1&&(g(0,"app-navbar"),t(1,"div",0)(2,"div",1)(3,"button",2),S("click",function(){return s.goBack()}),v(),t(4,"svg",3),g(5,"path",4),i(),n(6," Back to Assets "),i()(),d(7,P,2,1,"div",5),d(8,F,4,0,"div",6),d(9,G,29,6),i()),e&2&&(o(7),l(s.errorMessage?7:-1),o(),l(s.loading?8:-1),o(),l(s.asset&&!s.loading?9:-1))},dependencies:[w,M,E],encapsulation:2})};export{R as AssetDetailComponent};
