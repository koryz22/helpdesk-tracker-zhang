import{a as A}from"./chunk-HS72ZNLO.js";import{a as P}from"./chunk-664333HR.js";import{B as c,C as y,Ca as I,I as C,J as m,K as p,M as S,N as _,P as t,Q as i,R as s,T as w,U as g,X as u,Y as r,Z as l,_ as x,ea as v,ia as f,ja as h,p as b,q as k,qa as T,ra as M,wa as D,x as a,ya as E}from"./chunk-IIWWASKY.js";var B=(o,n)=>n.id;function z(o,n){if(o&1&&(t(0,"div",5),r(1),i()),o&2){let e=g();a(),x(" ",e.errorMessage," ")}}function R(o,n){o&1&&(t(0,"div",6),s(1,"div",8),t(2,"p",9),r(3,"Loading ticket details..."),i()())}function U(o,n){if(o&1&&(t(0,"div")(1,"dt",15),r(2,"User"),i(),t(3,"dd",18),r(4),i()()),o&2){let e=g(2);a(4),l(e.ticket.userName)}}function L(o,n){if(o&1&&(t(0,"div",23)(1,"div",24)(2,"span"),b(),t(3,"svg",25),s(4,"path",26),i()()(),k(),t(5,"div",27)(6,"p",28),r(7),i(),t(8,"p",29),r(9),i(),t(10,"p",30),r(11),f(12,"date"),i()()()),o&2){let e=n.$implicit,d=g(2);a(2),u(v("h-8 w-8 rounded-full ",d.getTimelineColor(e.type)," flex items-center justify-center ring-8 ring-white")),a(2),C("d",d.getTimelineIcon(e.type)),a(3),l(e.title),a(2),l(e.description),a(2),l(h(12,7,e.timestamp,"short"))}}function N(o,n){if(o&1&&(t(0,"div",7)(1,"div",10)(2,"div",11)(3,"h1",12),r(4,"Ticket Details"),i()(),t(5,"div",13)(6,"dl",14)(7,"div")(8,"dt",15),r(9,"Title"),i(),t(10,"dd",16),r(11),i()(),t(12,"div")(13,"dt",15),r(14,"Priority"),i(),t(15,"dd",17)(16,"span"),r(17),i()()(),t(18,"div")(19,"dt",15),r(20,"Description"),i(),t(21,"dd",18),r(22),i()(),t(23,"div")(24,"dt",15),r(25,"Status"),i(),t(26,"dd",17)(27,"span"),r(28),i()()(),m(29,U,5,1,"div"),t(30,"div")(31,"dt",15),r(32,"Created Date"),i(),t(33,"dd",18),r(34),f(35,"date"),i()(),t(36,"div")(37,"dt",15),r(38,"Last Updated"),i(),t(39,"dd",18),r(40),f(41,"date"),i()()()()(),t(42,"div",10)(43,"div",11)(44,"h2",19),r(45,"Activity Timeline"),i()(),t(46,"div",13)(47,"div",20),s(48,"div",21),t(49,"div",22),S(50,L,13,10,"div",23,B),i()()()()()),o&2){let e=g();a(11),l(e.ticket.title),a(5),u(v("inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold ",e.getPriorityColor(e.ticket.priority))),a(),x(" ",e.ticket.priority," "),a(5),l(e.ticket.description||"No description provided"),a(5),u(v("inline-flex items-center px-3 py-1 rounded-full text-sm font-semibold ",e.getStatusColor(e.ticket.status))),a(),x(" ",e.ticket.status," "),a(),p(e.isAdmin?29:-1),a(5),l(h(35,13,e.ticket.createdDate,"short")),a(6),l(h(41,16,e.ticket.lastUpdatedDate,"short")),a(10),_(e.timelineEvents)}}var O=class o{constructor(n,e,d,j){this.route=n;this.router=e;this.ticketService=d;this.authService=j;this.isAdmin=this.authService.isAdmin()}ticket=null;loading=!1;errorMessage="";isAdmin=!1;timelineEvents=[{id:"1",type:"created",title:"Ticket Created",description:"Initial ticket submission",timestamp:new Date(Date.now()-1440*60*1e3)},{id:"2",type:"assigned",title:"Ticket Assigned",description:"Ticket assigned to support team",timestamp:new Date(Date.now()-720*60*1e3)},{id:"3",type:"status_change",title:"Status Updated",description:"Status changed to In Progress",timestamp:new Date(Date.now()-7200*1e3)}];ngOnInit(){let n=this.route.snapshot.paramMap.get("id");n?this.loadTicketDetails(n):this.errorMessage="Ticket ID not found"}loadTicketDetails(n){this.loading=!0,this.ticketService.getTicket(n).subscribe({next:e=>{this.ticket=e;let d=this.authService.getCurrentUser();if(!this.isAdmin&&d&&this.ticket.userID!==d.userID){this.errorMessage="You do not have permission to view this ticket",this.loading=!1;return}this.loading=!1},error:e=>{console.error("Error loading ticket:",e),this.errorMessage="Failed to load ticket details",this.loading=!1}})}goBack(){this.isAdmin?this.router.navigate(["/dashboard/admin"]):this.router.navigate(["/dashboard/user"])}getPriorityColor(n){switch(n){case"High":return"bg-red-100 text-red-800";case"Medium":return"bg-yellow-100 text-yellow-800";case"Low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}}getStatusColor(n){switch(n){case"Open":return"bg-blue-100 text-blue-800";case"In Progress":return"bg-yellow-100 text-yellow-800";case"Resolved":return"bg-green-100 text-green-800";case"Closed":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}}getTimelineIcon(n){switch(n){case"created":return"M12 6v6m0 0v6m0-6h6m-6 0H6";case"assigned":return"M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z";case"status_change":return"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z";case"comment":return"M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z";default:return"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"}}getTimelineColor(n){switch(n){case"created":return"bg-blue-500";case"assigned":return"bg-purple-500";case"status_change":return"bg-green-500";case"comment":return"bg-gray-500";default:return"bg-gray-400"}}static \u0275fac=function(e){return new(e||o)(c(D),c(E),c(A),c(I))};static \u0275cmp=y({type:o,selectors:[["app-ticket-detail"]],decls:10,vars:3,consts:[[1,"max-w-7xl","mx-auto","px-4","sm:px-6","lg:px-8","py-8"],[1,"mb-6"],[1,"inline-flex","items-center","px-3","py-1.5","border","border-gray-300","rounded-md","text-xs","font-medium","text-gray-700","bg-white","hover:bg-gray-50","focus:outline-none","focus:ring-2","focus:ring-offset-2","focus:ring-primary",3,"click"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","mr-1.5"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2","d","M10 19l-7-7m0 0l7-7m-7 7h18"],[1,"mb-6","bg-red-50","border","border-red-200","text-red-600","px-4","py-3","rounded"],[1,"text-center","py-12"],[1,"space-y-8"],[1,"inline-block","animate-spin","rounded-full","h-8","w-8","border-b-2","border-primary"],[1,"mt-2","text-gray-600"],[1,"bg-white","rounded-lg","shadow-md","overflow-hidden","border","border-gray-200"],[1,"px-6","py-4","border-b","border-gray-200","bg-gray-50"],[1,"text-2xl","font-bold","text-gray-900"],[1,"px-6","py-6"],[1,"grid","grid-cols-1","gap-x-4","gap-y-6","sm:grid-cols-2"],[1,"text-sm","font-medium","text-gray-500"],[1,"mt-1","text-md","font-semibold","text-gray-900"],[1,"mt-1"],[1,"mt-1","text-md","text-gray-900"],[1,"text-xl","font-semibold","text-gray-900"],[1,"relative"],[1,"absolute","top-4","left-0","right-0","h-0.5","bg-gray-200"],[1,"flex","justify-between"],[1,"flex","flex-col","items-center","text-center","flex-1"],[1,"relative","z-10"],["fill","none","stroke","currentColor","viewBox","0 0 24 24",1,"h-4","w-4","text-white"],["stroke-linecap","round","stroke-linejoin","round","stroke-width","2"],[1,"mt-3","px-2"],[1,"text-xs","font-medium","text-gray-900"],[1,"text-xs","text-gray-500"],[1,"text-xs","text-gray-400","mt-1"]],template:function(e,d){e&1&&(s(0,"app-navbar"),t(1,"div",0)(2,"div",1)(3,"button",2),w("click",function(){return d.goBack()}),b(),t(4,"svg",3),s(5,"path",4),i(),r(6," Back to Dashboard "),i()(),m(7,z,2,1,"div",5),m(8,R,4,0,"div",6),m(9,N,52,19,"div",7),i()),e&2&&(a(7),p(d.errorMessage?7:-1),a(),p(d.loading?8:-1),a(),p(d.ticket&&!d.loading?9:-1))},dependencies:[M,P,T],styles:['.timeline-item[_ngcontent-%COMP%]{position:relative}.timeline-item[_ngcontent-%COMP%]:not(:last-child):after{content:"";position:absolute;left:1rem;top:2rem;bottom:-1rem;width:2px;background-color:#e5e7eb}.timeline-icon[_ngcontent-%COMP%]{position:relative;z-index:1}.timeline-container[_ngcontent-%COMP%]{max-height:600px;overflow-y:auto}.timeline-container[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.timeline-container[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:#f1f1f1;border-radius:3px}.timeline-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#c1c1c1;border-radius:3px}.timeline-container[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#a8a8a8}']})};export{O as TicketDetailComponent};
